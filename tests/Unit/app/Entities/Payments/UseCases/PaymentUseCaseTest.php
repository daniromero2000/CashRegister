<?php

namespace Tests\Unit\app\Entities\Payments\UseCases;

use App\Entities\CashRegisters\Repositories\Interfaces\CashRegisterRepositoryInterface;
use App\Entities\Payments\Repositories\Interfaces\PaymentRepositoryInterface;
use App\Entities\Payments\UseCases\Interfaces\PaymentUseCaseInterface;
use App\Entities\Payments\UseCases\PaymentUseCase;
use App\Entities\TransactionLogs\Repositories\Interfaces\TransactionLogRepositoryInterface;
use Monolog\Test\TestCase;

/**
 * Class PaymentUseCaseTest
 * @package Tests\Unit\app\Entities\Payments\UseCases
 */
class PaymentUseCaseTest extends TestCase
{
    protected function setUp(): void
    {
        parent::setUp(); // TODO: Change the autogenerated stub
    }

    /**
     * @throws \PHPUnit\Framework\ExpectationFailedException
     * @throws \SebastianBergmann\RecursionContext\InvalidArgumentException
     * This function aims to simulate an exception at the time of creating a payment
     */
    public function testCreatePaymentUseCaseError(): void
    {
        $paymentRepositoryMock = \Mockery::mock(PaymentRepositoryInterface::class);
        $transactionLogRepositoryMock = \Mockery::mock(TransactionLogRepositoryInterface::class);
        $cashRegisterRepositoryMock = \Mockery::mock(CashRegisterRepositoryInterface::class);

        $paymentUseCase = new PaymentUseCase(
            $paymentRepositoryMock,
            $cashRegisterRepositoryMock,
            $transactionLogRepositoryMock
        );

        $request = $paymentUseCase->createPayment(['createPayment']);

        $this->assertEquals(['status' => false, 'message' => 'Undefined index: customer_payment'], $request);
    }
}
